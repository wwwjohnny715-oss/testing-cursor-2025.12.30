(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,89271,e=>{"use strict";e.s(["GRADE_OPTIONS",0,["S1","S2","S3","S4","S5","S6","retaker","P1","P2","P3","P4","P5","P6"],"SUBJECT_OPTIONS",0,["中文","英文","數學","物理","化學","生物","M1","M2","經濟","會計","歷史","中史","地理","其他"]])},15288,e=>{"use strict";var t=e.i(43476),a=e.i(75157);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function l({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function r({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...s})}function n({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...s})}function c({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>c,"CardDescription",()=>n,"CardHeader",()=>l,"CardTitle",()=>r])},30307,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(48148),l=e.i(15288),r=e.i(67489),n=e.i(84774),c=e.i(89271);function d({courses:e}){let d=(0,s.useTranslations)(),o=new Date,[i,h]=(0,a.useState)("teacher-month"),[u,m]=(0,a.useState)(`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`),x=(0,a.useMemo)(()=>{let e=[];for(let t=0;t<12;t++){let a=new Date(o.getFullYear(),o.getMonth()-t,1),s=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`,l=`${a.getFullYear()}年${a.getMonth()+1}月`;e.push({value:s,label:l})}return e},[o]),j=(0,a.useMemo)(()=>{let[t,a]=u.split("-").map(Number),s=new Date(t,a-1,1),l=new Date(t,a,0,23,59,59,999),r=t=>t?e.filter(e=>e.sessions.some(e=>{let t=new Date(e.date);return t>=s&&t<=l})):e;if("teacher-month"===i||"teacher-total"===i){let e=r("teacher-month"===i),t={};for(let a of e){let e=a.teacher.id;for(let s of(t[e]||(t[e]={teacherCode:a.teacher.teacherCode,name:a.teacher.name,studentCodes:new Set}),a.enrollments))t[e].studentCodes.add(s.student.studentCode)}return Object.entries(t).map(([e,t])=>({id:e,teacherCode:t.teacherCode,name:t.name,count:t.studentCodes.size})).sort((e,t)=>t.count-e.count)}{let e=r("subject-month"===i),t={};for(let a of e)for(let e of a.teacher.subjects)for(let s of(t[e]||(t[e]=new Set),a.enrollments))t[e].add(s.student.studentCode);return c.SUBJECT_OPTIONS.filter(e=>t[e]&&t[e].size>0).map(e=>({subject:e,count:t[e]?.size||0})).sort((e,t)=>t.count-e.count)}},[e,i,u]),C=i.startsWith("teacher");return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(l.Card,{children:[(0,t.jsxs)(l.CardHeader,{children:[(0,t.jsx)(l.CardTitle,{children:d("stats.enrollments")}),(0,t.jsx)(l.CardDescription,{children:d("stats.totalStudents")})]}),(0,t.jsx)(l.CardContent,{children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,t.jsx)("div",{className:"w-48",children:(0,t.jsxs)(r.Select,{value:i,onValueChange:e=>h(e),children:[(0,t.jsx)(r.SelectTrigger,{children:(0,t.jsx)(r.SelectValue,{})}),(0,t.jsxs)(r.SelectContent,{children:[(0,t.jsx)(r.SelectItem,{value:"teacher-month",children:d("stats.byTeacherMonthly")}),(0,t.jsx)(r.SelectItem,{value:"teacher-total",children:d("stats.byTeacherCumulative")}),(0,t.jsx)(r.SelectItem,{value:"subject-month",children:d("stats.bySubjectMonthly")}),(0,t.jsx)(r.SelectItem,{value:"subject-total",children:"按科目（累积）"})]})]})}),("teacher-month"===i||"subject-month"===i)&&(0,t.jsx)("div",{className:"w-40",children:(0,t.jsxs)(r.Select,{value:u,onValueChange:m,children:[(0,t.jsx)(r.SelectTrigger,{children:(0,t.jsx)(r.SelectValue,{})}),(0,t.jsx)(r.SelectContent,{children:x.map(e=>(0,t.jsx)(r.SelectItem,{value:e.value,children:e.label},e.value))})]})})]})})]}),(0,t.jsx)(l.Card,{children:(0,t.jsx)(l.CardContent,{className:"pt-6",children:(0,t.jsxs)(n.Table,{children:[(0,t.jsx)(n.TableHeader,{children:(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableHead,{children:d(C?"auth.teacher":"teachers.subjects")}),C&&(0,t.jsx)(n.TableHead,{children:d("teachers.teacherCode")}),(0,t.jsx)(n.TableHead,{className:"text-right",children:d("courses.studentCount")})]})}),(0,t.jsx)(n.TableBody,{children:0===j.length?(0,t.jsx)(n.TableRow,{children:(0,t.jsx)(n.TableCell,{colSpan:C?3:2,className:"h-24 text-center text-muted-foreground",children:d("stats.noData")})}):C?j.map(e=>(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableCell,{className:"font-medium",children:e.name}),(0,t.jsx)(n.TableCell,{className:"font-mono",children:e.teacherCode}),(0,t.jsx)(n.TableCell,{className:"text-right",children:e.count})]},e.id)):j.map(e=>(0,t.jsxs)(n.TableRow,{children:[(0,t.jsx)(n.TableCell,{className:"font-medium",children:e.subject}),(0,t.jsx)(n.TableCell,{className:"text-right",children:e.count})]},e.subject))})]})})})]})}e.s(["EnrollmentStats",()=>d])}]);